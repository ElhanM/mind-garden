#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Frontend formatting
echo "ğŸ” Checking frontend formatting..."
cd frontend && npm run format

# Check if any files were changed by Prettier in frontend
if git diff --name-only --exit-code .; then
  echo "âœ… Frontend code is properly formatted!"
else
  echo "âŒ Frontend commit failed due to formatting issues."
  echo "ğŸ”§ The formatting issues have been fixed. Please run:"
  echo "    git add ."
  echo "    git commit"
  exit 1
fi

# Backend formatting
echo "ğŸ” Checking backend formatting..."
cd ../backend && npm run format

# Check if any files were changed by Prettier in backend
if git diff --name-only --exit-code .; then
  echo "âœ… Backend code is properly formatted!"
else
  echo "âŒ Backend commit failed due to formatting issues."
  echo "ğŸ”§ The formatting issues have been fixed. Please run:"
  echo "    git add ."
  echo "    git commit"
  exit 1
fi

cd ..